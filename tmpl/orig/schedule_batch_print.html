<!DOCTYPE html>
<html>
<head>
<%include file="header_inc_v4.html" />
<title>POSX - Schedule - Batch Print</title>

%if view_only:
<script>
function view_receipt(sid)
{
    open_wnd('hist?fn=printreceipt&rid=' + sid,'posx_print_wnd', 992, 700);
}

function view_salesorder(sid)
{
    open_wnd('sync?fn=printorder&type=2&rid=' + sid,'posx_so_wnd', 992, 700);
}

function view_customer(sid)
{
    open_wnd('hist?fn=custhist&dg_type=5&cid=' + sid,'posx_customer_hist', 992, 700);
}

function view_item(sid)
{
    open_wnd('hist?fn=itemhist&tid=' + sid,'posx_item_hist', 992, 700);
}

function view_map()
{
    var o = $(this).children('div');
    var s = escape( $.trim($(o[0]).children('span').html()) + ',' + $.trim($(o[1]).html()) );
    open_wnd('http://maps.google.com/maps?q=' + s, 'posx_map', 992, 700);
}


$(function() {
$(document).tooltip();
})
</script>
%endif

<style type="text/css">

.p_doc {page-break-after:always;width:712px;margin:0 auto;min-height:400px;position:relative;}
.p_doc_meta {border-bottom:1px solid #ccc;margin-bottom:5px;font-weight:bold;position:relative;height:26px;}
.p_doc_meta >div {position:absolute;top:0;bottom:0;text-align:center}
.p_doc_meta >div:nth-child(1) {width:200px;right:300px}
.p_doc_meta >div:nth-child(2) {width:50px;right:250px}
.p_doc_meta >div:nth-child(3) {width:250px;right:0;text-align:right}

.p_doc_memo {border:1px solid #ccc;white-space:pre-wrap;padding:5px 5px;}
.p_doc > div {margin-bottom:8px}

.p_doc_hdr {position:relative;}
.p_doc_hdr > div {position:relative;height:20px;line-height:20px;font-weight:bold;font-size:18px;}
.p_doc_hdr > div > div {position:absolute;top:0;bottom:0;text-align:right}
.p_doc_hdr > div > div:nth-child(1) {left:0;width:100px;}
.p_doc_hdr > div > div:nth-child(2) {left:110px;width:210px;text-align:right}
.p_doc_hdr > div > div:nth-child(3) {right:260px;width:100px;}
.p_doc_hdr > div > div:nth-child(4) {right:0;width:250px;}
.p_doc_hdr > div:nth-child(1) > div:nth-child(2) {cursor:pointer}

.p_doc_addr {}
.p_doc_addr > div.c_addr {position:relative;margin-top:10px;width:298px;border:1px solid #ccc;padding:10px;}
.p_doc_addr > div.c_addr > div:first-child {height:20px;line-height:20px;font-weight:bold;position:absolute;padding:0 10px;left:5px;top:-10px;background-color:#FFF;text-align:center}
.p_doc_addr > div.c_addr > div:nth-child(2) {font-weight:bold;cursor:pointer}
.p_doc_addr > div.c_addr > div:nth-child(3) {cursor:pointer}
.p_doc_addr > .billto {float:left}
.p_doc_addr > .shipto {float:right}

.prntbl {position:relative}
.prntbl >.prntbl_row_hdr, .prntbl >.prntbl_row_ftr, .prntbl >.prntbl_cnt {overflow:visible;position:static}
.prntbl .prntbl_row_hdr {border-bottom:none}
.prntbl .prntbl_row >div:last-child {border-right:none}
.prntbl .prntbl_row >div:nth-child(1) {width:50px;font-weight:bold}
.prntbl .prntbl_row >div:nth-child(3) {width:60px}
.prntbl .prntbl_row >div:nth-child(4) {width:130px;font-weight:bold}

%if view_only:
.prntbl .prntbl_row >div:nth-child(2) {width:386px}
.prntbl .prntbl_row >div:nth-child(5) {width:80px;font-weight:bold}
%else:
.prntbl .prntbl_row >div:nth-child(2) {width:356px}
.prntbl .prntbl_row >div:nth-child(5) {width:80px;font-weight:bold}
.prntbl .prntbl_row >div:nth-child(6) {width:29px}
%endif

.prntbl .prntbl_row_ftr >div:nth-child(1) {width:710px;font-weight:bold}

%if view_only:
.p_doc_note {font-size:18px;margin-top:12px;border-top:1px solid #ccc;padding-top:4px;}
.p_doc_note >div {padding-left:100px;margin:2px 0}
.p_doc_note >div >div:nth-child(1) {position:absolute;left:0px;width:90px;text-align:right;font-weight:bold;color:#98562a}
.p_doc_note >div >div:nth-child(2) {white-space:pre-wrap}
.p_doc_note .doc_note_type_1 {color:#418c46}
%else:
.p_doc_signature {display:none}
.p_doc_signature .xlabel {position:absolute;width:320px;margin:0}
.p_doc_signature .xlabel > div:nth-child(1) {width:125px}
.p_doc_signature .xlabel > div:nth-child(2) {left:135px;border-bottom:1px solid #000}
.p_doc_signature .xlabel:nth-child(1) {right:330px;}
.p_doc_signature .xlabel:nth-child(2) {right:0px;}
%endif

@media print {
div {border-color:#000 !important}
.prntbl {-webkit-print-color-adjust:exact}
.p_doc_signature {display:block}
}
@page {
margin:60px 50px;
}

</style>

</head>
%if auto_print:
<body onload="window.print();setTimeout('window.close()', 0)">
%else:
<body>
%endif

%for i in range(len(sc_docs)):
<%
r = sc_docs[i]
gjs = r['gjs']
%>
<div class="p_doc">
%if not view_only:
<div class="p_doc_meta"><div>${r['zone_nz']|h}</div><div>${i + 1}/${len(sc_docs)}</div><div>${cts_s}</div></div>
%endif
<!-- +hdr -->
<div class="p_doc_hdr">
<!-- +i_hdr -->
<div>
<div>${r['doc_type'] and 'Receipt' or 'SalesOrder'}:</div>
%if view_only:
<div onclick="${r['doc_type'] and "view_receipt" or "view_salesorder"}('${r['doc_sid']}')">${r['num']|h}</div>
%else:
<div>${r['num']|h}</div>
%endif
<div>Assoc:</div><div>${r['assoc']|h}${r['assoc']!=r['cashier'] and u' (%s)' % r['cashier'] or ''|h}</div>
</div>
<!-- -i_hdr -->
<!-- +i_hdr -->
<div>
<div>Type:</div><div>${r['type_s']|h}</div>
<div>Count:</div><div>${r['count_s']|h}</div>
</div>
<!-- -i_hdr -->
<!-- +i_hdr -->
<div>
<div>Date:</div><div>${r['doc_date']}</div>
<div></div><div></div>
</div>
<!-- -i_hdr -->
</div>
<!-- -hdr -->

%if gjs['memo'] or r['sc_note']:
<!-- +i_memo -->
<div class="p_doc_memo">${(r['sc_note'] + '\n' + gjs['memo']).strip()|h}</div>
<!-- -i_memo -->
%endif

%if gjs['customer'] or gjs['shipping']:
<div class="p_doc_addr">

%if gjs['customer']:
<%
cust = gjs['customer']
%>
<div class="c_addr billto">
<div>Bill To:</div>
<div${view_only and ' onclick="view_customer(\''+str(r['cid'])+'\')"' or ''}>${(cust['company'] or cust['name'] or '')|h}</div>
<div${view_only and ' onclick="view_map.call(this)"' or ''}>
<div><span>${cust['addr1']}</span>
%if cust['addr2']:
<br />${cust['addr2']|h}
%endif
</div>
<div>${cust['city']|h}, ${cust['state']|h} ${cust['zip']|h}</div>
%if cust['phone']:
<div>${cust['phone']|h}</div>
%endif
</div>
</div>
%endif

%if gjs['shipping']:
<%
cust = gjs['shipping']
%>
<div class="c_addr shipto">
<div>Ship To:</div>
<div>${(cust['company'] or cust['name'] or '')|h}</div>
<div${view_only and ' onclick="view_map.call(this)"' or ''}>
<div><span>${cust['addr1']}</span>
%if cust['addr2']:
<br />${cust['addr2']|h}
%endif
</div>
<div>${cust['city']|h}, ${cust['state']|h} ${cust['zip']|h}</div>
%if cust['phone']:
<div>${cust['phone']|h}</div>
%endif
</div>
</div>
%endif

<div style="clear:both"></div>
</div>
%endif

<div class="prntbl">
<div class="prntbl_row prntbl_row_hdr"><div>NUM</div><div>Name</div><div>UPrice</div><div>ALU</div><div>Qty</div>${not view_only and '<div>CK</div>' or ''}</div>
<div class="prntbl_cnt">
%for t in r['ijs']:
<div class="prntbl_row">
<div>${t['itemno'] or ''}</div>
<div>${t['desc1']|h}</div>
<div>${'%0.2f' % (round_ex(t['price']),)}</div>
<div>${t['alu']|h}</div>
%if r['doc_type']:
<div>${int(t['qty'])}${t['uom'] and ' ' + t['uom'] or ''|h}</div>
%else:
<div>${int(t['qtysent'])} / ${int(t['qty'])}${t['uom'] and ' ' + t['uom'] or ''|h}</div>
%endif
${not view_only and '<div></div>' or ''}
</div>
%endfor
</div>
<div class="prntbl_row prntbl_row_ftr"><div>Total: $${'%0.2f' % (round_ex(gjs['total']),)}</div></div>
</div>

%if view_only and r['notes']:
<div class="p_doc_note">
%for n in r['notes']:
<div title="${n[0]|h}" class="doc_note_type_${n[1]&1}"><div>${n[3]|h}:</div><div>${n[2]|h}</div></div>
%endfor
</div>
%endif

%if not view_only:
<div class="p_doc_signature">
<div class="xlabel"><div>执货:</div><div></div></div>
<div class="xlabel"><div>检查:</div><div></div></div>
</div>
%endif

</div>
%endfor

</body>
</html>